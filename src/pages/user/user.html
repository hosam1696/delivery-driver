<ion-header>

  <ion-navbar color="primary">
    <ion-title>
      <span *ngIf="orderStatus == 'accepted' || orderStatus == 'waiting' && driverOrder?.status != 'ongoing'">
        الشركة
      </span>
      <span *ngIf="driverOrder?.status == 'ongoing' || orderStatus == 'ongoing' || orderStatus == 'completed'">
        العميل
      </span>
    </ion-title>
    <ion-buttons end>
      <button ion-button icon-only menuToggle>
        <ion-icon color="dark" name="menu"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>

</ion-header>

<ion-content padding>

  <ng-template [ngIf]="driverOrder && (orderStatus == 'accepted' || orderStatus == 'waiting' || orderStatus == 'processing')">


    <section class="avatar-section">
      <div class="avatar">
        <img [src]="'https://www.moovstore.com/' + driverOrder.company.logo" alt="">
      </div>
      <h2>{{driverOrder.company.name}}</h2>
      <p>{{driverOrder.company.phone}}</p>
      <p>الدفع عند الاستلام</p>
      <p class="small" *ngIf="orderStatus && orderStatus != 'waiting' && (orderStatus == 'processing' || orderStatus == 'ongoing')">{{orderStatus | translate}}</p>

    </section>


    <div class="actions">
      <div text-center>
        <button ion-button round [hidden]="orderStatus == 'waiting'" (click)="openCompanyLocation()">
          ابدأ رحلتك الان لاستلام الطلب
        </button>
      </div>
      <div text-center [hidden]="orderStatus == 'waiting'">
        <button ion-button outline round (click)="onReceiving()" >
          تم الاستلام
        </button>
        <button ion-button outline color="danger" round (click)="showModal()">
          الغاء
        </button>
      </div>
    </div>

  </ng-template>


  <ng-template [ngIf]="requestUser && orderStatus != 'accepted' &&  orderStatus != 'waiting' &&  orderStatus != 'processing'  && (driverOrder?.status == 'ongoing' || orderStatus == 'ongoing' || orderStatus == 'completed')">

    <section class="avatar-section">
      <div class="avatar">
        <img [src]="'https://www.moovstore.com/'+requestUser?.logo" alt="">
      </div>
      <h2>{{requestUser?.name}}</h2>
      <p>{{requestUser?.phone}}</p>
      <p>{{requestUser?.gender | translate}}</p>
      <p>الدفع عند الاستلام</p>
      <p class="small" *ngIf="driverOrder.status && (driverOrder.status == 'processing' || driverOrder.status == 'ongoing') && driverOrder.status != 'completed'">{{orderStatus | translate}}</p>
    </section>
    
    
    <div class="actions" *ngIf="orderStatus != 'completed'">
      <div text-center>
        <button ion-button round (click)="openUserLocation()">
          ابدأ رحلتك الان لتوصيل الطلب
        </button>
      </div>
      <div text-center>
        <button ion-button outline round (click)="onDeliver()" [hidden]="orderStatus == 'waiting'">
          تم التوصيل
        </button>
      </div>

      <!-- TODO: may add rating to the delivery trip -->
      <div class="action" *ngIf="orderStatus == 'completed'">
        تم التوصيل
      </div>
    </div>
  </ng-template>
  <ion-fab bottom right hidden>
    <button ion-fab mini (click)="goToMaps()">
      <img src="assets/imgs/map-pin.png" alt="">
    </button>
  </ion-fab>
</ion-content>
